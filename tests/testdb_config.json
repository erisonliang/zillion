{
    "facts": [
        {
            "name": "revenue",
            "type": "Numeric(10,2)",
            "aggregation": "sum",
            "rounding": 2
        },
        {
            "name": "revenue_avg",
            "type": "Numeric(10,2)",
            "aggregation": "avg",
            "rounding": 2
        }
    ],

    "dimensions": [
        {
            "name": "partner_id",
            "type": "String(32)"
        }
    ],
    
    "datasources": {
        "testdb": {
            "tables": {
                "partners": {
                    "type": "dimension",
                    "autocolumns": true,
                    "columns": {
                        "id": {
                            "fields": ["partner_id"]
                        },
                        "name": {
                            "fields": ["partner_name"]
                        }
                    }
                },
                
                "campaigns": {
                    "type": "dimension",
                    "autocolumns": true,
                    "parent": "partners",
                    "columns": {
                        "id": {
                            "fields": ["campaign_id"]
                        },
                        "name": {
                            "fields": ["campaign_name"]
                        },
                        "partner_id": {
                            "fields": ["partner_id"]
                        }
                    }
                },

                "leads": {
                    "type": "fact",
                    "autocolumns": true,
                    "columns": {
                        "id": {
                            "fields": ["lead_id"]
                        },
                        "created_at": {
                            "fields": ["created_at"]
                        },
                        "campaign_id": {
                            "fields": ["campaign_id"]
                        }
                    }
                },
                
                "sales": {
                    "type": "fact",
                    "autocolumns": true,
                    "parent": "leads",
                    "columns": {
                        "id": {
                            "fields": ["sale_id"]
                        },
                        "created_at": {
                            "fields": ["created_at"]
                        },
                        "lead_id": {
                            "fields": ["lead_id"]
                        },
                        "revenue": {
                            "fields": ["revenue", "revenue_avg"]
                        }
                    }
                }
            }
        }
    }
}
